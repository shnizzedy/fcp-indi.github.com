
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Nodes &#8212; C-PAC 1.7.1 Beta documentation</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    
    <link rel="index" title="Index" href="../genindex" />
    <link rel="search" title="Search" href="../search" />
    <link rel="next" title="Workflow Documentation" href="workflow_documentation" />
    <link rel="prev" title="Installing CPAC" href="installation" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="workflow_documentation" title="Workflow Documentation"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="installation" title="Installing CPAC"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index">C-PAC 1.7.1 Beta documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index" accesskey="U">Welcome to CPAC’s developer documentation!</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Nodes</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="nodes">
<h1>Nodes<a class="headerlink" href="#nodes" title="Permalink to this headline">¶</a></h1>
<dl class="py class">
<dt id="nipype.pipeline.engine.nodes.Node">
<em class="property">class </em><code class="sig-prename descclassname">nipype.pipeline.engine.nodes.</code><code class="sig-name descname">Node</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">interface</span></em>, <em class="sig-param"><span class="n">name</span></em>, <em class="sig-param"><span class="n">iterables</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">itersource</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">synchronize</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">overwrite</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">needed_outputs</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">run_without_submitting</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">n_procs</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">mem_gb</span><span class="o">=</span><span class="default_value">0.2</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/nipype/pipeline/engine/nodes#Node"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nipype.pipeline.engine.nodes.Node" title="Permalink to this definition">¶</a></dt>
<dd><p>Wraps interface objects for use in pipeline</p>
<p>A Node creates a sandbox-like directory for executing the underlying
interface. It will copy or link inputs into this directory to ensure that
input data are not overwritten. A hash of the input state is used to
determine if the Node inputs have changed and whether the node needs to be
re-executed.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">nipype</span> <span class="kn">import</span> <span class="n">Node</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">nipype.interfaces</span> <span class="kn">import</span> <span class="n">spm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">realign</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">spm</span><span class="o">.</span><span class="n">Realign</span><span class="p">(),</span> <span class="s1">&#39;realign&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">realign</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">in_files</span> <span class="o">=</span> <span class="s1">&#39;functional.nii&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">realign</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">register_to_mean</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">realign</span><span class="o">.</span><span class="n">run</span><span class="p">()</span> 
</pre></div>
</div>
<dl class="py method">
<dt id="nipype.pipeline.engine.nodes.Node.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">interface</span></em>, <em class="sig-param"><span class="n">name</span></em>, <em class="sig-param"><span class="n">iterables</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">itersource</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">synchronize</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">overwrite</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">needed_outputs</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">run_without_submitting</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">n_procs</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">mem_gb</span><span class="o">=</span><span class="default_value">0.2</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/nipype/pipeline/engine/nodes#Node.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nipype.pipeline.engine.nodes.Node.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>interface</strong><span class="classifier">interface object</span></dt><dd><p>node specific interface (fsl.Bet(), spm.Coregister())</p>
</dd>
<dt><strong>name</strong><span class="classifier">alphanumeric string</span></dt><dd><p>node specific name</p>
</dd>
<dt><strong>iterables</strong><span class="classifier">generator</span></dt><dd><p>Input field and list to iterate using the pipeline engine
for example to iterate over different frac values in fsl.Bet()
for a single field the input can be a tuple, otherwise a list
of tuples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">node</span><span class="o">.</span><span class="n">iterables</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;frac&#39;</span><span class="p">,[</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.6</span><span class="p">,</span><span class="mf">0.7</span><span class="p">])</span>
<span class="n">node</span><span class="o">.</span><span class="n">iterables</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;fwhm&#39;</span><span class="p">,[</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">]),(</span><span class="s1">&#39;fieldx&#39;</span><span class="p">,[</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.6</span><span class="p">,</span><span class="mf">0.7</span><span class="p">])]</span>
</pre></div>
</div>
<p>If this node has an itersource, then the iterables values
is a dictionary which maps an iterable source field value
to the target iterables field values, e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">inputspec</span><span class="o">.</span><span class="n">iterables</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;images&#39;</span><span class="p">,[</span><span class="s1">&#39;img1.nii&#39;</span><span class="p">,</span> <span class="s1">&#39;img2.nii&#39;</span><span class="p">]])</span>
<span class="n">node</span><span class="o">.</span><span class="n">itersource</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;inputspec&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;frac&#39;</span><span class="p">])</span>
<span class="n">node</span><span class="o">.</span><span class="n">iterables</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;frac&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;img1.nii&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">],</span>
                           <span class="s1">&#39;img2.nii&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">]})</span>
</pre></div>
</div>
<p>If this node’s synchronize flag is set, then an alternate
form of the iterables is a [fields, values] list, where
fields is the list of iterated fields and values is the
list of value tuples for the given fields, e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">node</span><span class="o">.</span><span class="n">synchronize</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">node</span><span class="o">.</span><span class="n">iterables</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;frac&#39;</span><span class="p">,</span> <span class="s1">&#39;threshold&#39;</span><span class="p">),</span>
                  <span class="p">[(</span><span class="mf">0.5</span><span class="p">,</span> <span class="kc">True</span><span class="p">),</span>
                   <span class="p">(</span><span class="mf">0.6</span><span class="p">,</span> <span class="kc">False</span><span class="p">)]]</span>
</pre></div>
</div>
</dd>
<dt><strong>itersource: tuple</strong></dt><dd><p>The (name, fields) iterables source which specifies the name
of the predecessor iterable node and the input fields to use
from that source node. The output field values comprise the
key to the iterables parameter value mapping dictionary.</p>
</dd>
<dt><strong>synchronize: boolean</strong></dt><dd><p>Flag indicating whether iterables are synchronized.
If the iterables are synchronized, then this iterable
node is expanded once per iteration over all of the
iterables values.
Otherwise, this iterable node is expanded once per
each permutation of the iterables values.</p>
</dd>
<dt><strong>overwrite</strong><span class="classifier">Boolean</span></dt><dd><p>Whether to overwrite contents of output directory if it already
exists. If directory exists and hash matches it
assumes that process has been executed</p>
</dd>
<dt><strong>needed_outputs</strong><span class="classifier">list of output_names</span></dt><dd><p>Force the node to keep only specific outputs. By default all
outputs are kept. Setting this attribute will delete any output
files and directories from the node’s working directory that are
not part of the <cite>needed_outputs</cite>.</p>
</dd>
<dt><strong>run_without_submitting</strong><span class="classifier">boolean</span></dt><dd><p>Run the node without submitting to a job engine or to a
multiprocessing pool</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<div class="admonition note" id="mem-gb">
<p class="admonition-title">Note</p>
<p>Nipype Nodes have an initialization parameter <code class="docutils literal notranslate"><span class="pre">mem_gb</span></code> that differs from the <a class="reference internal" href="../user/run/help"><span class="doc">commandline option</span></a> <code class="docutils literal notranslate"><span class="pre">--mem_gb</span></code>. While the commandline option is a limit, the Node parameter is an estimate of the most memory that Node will consume when run. The Node parameter is not a limit; rather, this value is used to allocate system resources at runtime.</p>
<p>C-PAC automatically creates a JSON-like file called <code class="docutils literal notranslate"><span class="pre">callback.log</span></code> (via the function <a class="reference internal" href="#CPAC.utils.monitoring.log_nodes_cb" title="CPAC.utils.monitoring.log_nodes_cb"><code class="xref py py-func docutils literal notranslate"><span class="pre">log_nodes_cb</span></code></a>) when running. This file includes each Node’s estimated memory and memory observed at runtime. The Nipype utility function <a class="reference internal" href="#nipype.utils.draw_gantt_chart.log_to_dict" title="nipype.utils.draw_gantt_chart.log_to_dict"><code class="xref py py-func docutils literal notranslate"><span class="pre">log_to_dict</span></code></a> reads a log file generated by <code class="docutils literal notranslate"><span class="pre">log_nodes_cb</span></code> to a Python dictionary.</p>
<p>When a developer creates or modifies a Node in C-PAC, a <code class="docutils literal notranslate"><span class="pre">mem_gb</span></code> argument should be provided unless the default of 0.2 is expected to be sufficient. When testing, the <code class="docutils literal notranslate"><span class="pre">mem_gb</span></code> argument should be adjusted if the observed memory exceeds the estimate.</p>
</div>
<dl class="py function">
<dt id="CPAC.utils.monitoring.log_nodes_cb">
<code class="sig-prename descclassname">CPAC.utils.monitoring.</code><code class="sig-name descname">log_nodes_cb</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">node</span></em>, <em class="sig-param"><span class="n">status</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CPAC/utils/monitoring#log_nodes_cb"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CPAC.utils.monitoring.log_nodes_cb" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to record node run statistics to a log file as json
dictionaries</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>node</strong><span class="classifier">nipype.pipeline.engine.Node</span></dt><dd><p>the node being logged</p>
</dd>
<dt><strong>status</strong><span class="classifier">string</span></dt><dd><p>acceptable values are ‘start’, ‘end’; otherwise it is
considered and error</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd><p>this function does not return any values, it logs the node
status info to the callback logger</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="nipype.utils.draw_gantt_chart.log_to_dict">
<code class="sig-prename descclassname">nipype.utils.draw_gantt_chart.</code><code class="sig-name descname">log_to_dict</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">logfile</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/nipype/utils/draw_gantt_chart#log_to_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nipype.utils.draw_gantt_chart.log_to_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to extract log node dictionaries into a list of python
dictionaries and return the list as well as the final node</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>logfile</strong><span class="classifier">string</span></dt><dd><p>path to the json-formatted log file generated from a nipype
workflow execution</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>nodes_list</strong><span class="classifier">list</span></dt><dd><p>a list of python dictionaries containing the runtime info
for each nipype node</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index">
              <img class="logo" src="../_static/cpac_logo_vertical.png" alt="Logo"/>
            </a></p>
  <h3><a href="../index">Table of Contents</a></h3>
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../user/index">User Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index">Welcome to CPAC’s developer documentation!</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="installation">Installing CPAC</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Nodes</a></li>
<li class="toctree-l2"><a class="reference internal" href="workflow_documentation">Workflow Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="workflows/index">Workflows</a></li>
<li class="toctree-l2"><a class="reference internal" href="workflows/index#indices-and-tables">Indices and tables</a></li>
<li class="toctree-l2"><a class="reference internal" href="testing">Testing CPAC</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index#indices-and-tables">Indices and tables</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="workflow_documentation" title="Workflow Documentation"
             >next</a> |</li>
        <li class="right" >
          <a href="installation" title="Installing CPAC"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index">C-PAC 1.7.1 Beta documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index" >Welcome to CPAC’s developer documentation!</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Nodes</a></li> 
      </ul>
    </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2020, C-PAC Team.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.4.3.
    </div>
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-19224662-10"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-19224662-10');
    </script>
    <script defer src="https://fcp-indi.github.io/scripts/versionList.js"></script>

  </body>
</html>