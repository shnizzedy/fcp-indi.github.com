.. C-PAC documentation master file, created by
   sphinx-quickstart on Fri Jul 20 16:32:55 2012.
   You can adapt this file completely to your liking, but it should at least
   contain the root `toctree` directive.

Welcome to C-PAC's Documentation!
=================================

The C-PAC Mission
^^^^^^^^^^^^^^^^^

Once a distant goal, discovery science for the human connectome is now a reality. Researchers who previously struggled to obtain neuroimaging data from 20-30 participants are now exploring the functional connectome using data acquired from thousands of participants, made publicly available through the `1000 Functional Connectomes Project and the International Neuroimaging Data-sharing Initiative (INDI) <http://fcon_1000.projects.nitrc.org/>`_. However, in addition to access to data, scientists need access to tools that will facilitate data exploration. Such tools are particularly important for those who are inexperienced with the nuances of fMRI image analysis, or those who lack the programming support necessary for handling and analyzing large-scale datasets.

The Configurable Pipeline for the Analysis of Connectomes (C-PAC) is a configurable, open-source, Nipype-based, automated processing pipeline for resting state functional MRI (R-fMRI) data, for use by both novice and expert users. C-PAC was designed to bring the power, flexibility and elegance of the `Nipype platform <http://nipy.sourceforge.net/nipype/>`_ to users in a plug and play fashionâ€”without requiring the ability to program. Using an easy to read, text-editable configuration file or a graphical user interface, C-PAC users can rapidly orchestrate automated R-fMRI processing procedures, including:

* standard quality assurance measurements
* standard image preprocessing based upon user specified preferences
* generation of functional connectivity maps (e.g., :doc:`seed-based correlation analyses </sca>`)
* customizable extraction of time-series data
* generation of graphical representations of the connectomes at various scales (e.g., voxel, parcellation unit)
* generation of local R-fMRI measures (e.g., :doc:`regional homogeneity </reho>`, :doc:`voxel-matched homotopic connectivity </vmhc>`, :doc:`frequency amplitude measures </alff>`)

Importantly, C-PAC makes it possible to use a single configuration file to launch a factorial number of pipelines differing with respect to specific processing steps (e.g., spatial/temporal filter settings, global correction strategies, motion correction strategies, group analysis models). Additional noteworthy features include the ability to easily:

* customize C-PAC to handle any systematic directory organization
* specify Nipype distributed processing settings

C-PAC maintains key Nipype strengths, including the ability to:

* interface with different software packages (e.g., FSL, AFNI, ANTS)
* protect against redundant computation and/or storage
* automatically carry out input checking, bug tracking and reporting

Future updates will include more configurability, advanced analytic features (e.g., support vector machines, cluster analysis) and diffusion tensor imaging (DTI) capabilities.

For more information and additional tutorials, check out our `YouTube channel <https://www.youtube.com/channel/UCMhbaa3bF7oQgnAWX6HmyMQ>`_, as well as slides from our previous presentations:

* `CPAC Connectome Analysis in the Cloud <http://www.slideshare.net/CameronCraddock/cpac-connectome-analysis-in-the-cloud>`_
* `Open science resources for 'Big Data' Analyses of the human connectome <http://www.slideshare.net/CameronCraddock/open-science-resources-for-big-data-analyses-of-the-human-connectome>`_
* `Computational approaches for mapping the human connectome <http://www.slideshare.net/CameronCraddock/computational-approaches-for-mapping-the-human-connectome>`_

Latest Release: C-PAC v1.6.0 (Jan 3, 2020)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

**NEW FEATURES**

* **Anatomical-Refined BOLD Mask Generation.** A new method for creating the BOLD mask is available, which uses the T1 brain mask to refine the boundaries of the generated BOLD mask.
* **Carpet plots.** The Quality Control interface now includes carpet plots, which are useful for rapid visual inspection for motion and other artifacts.

**NEW FEATURES - Options that enhance reproducibility with fMRIPrep**

* **Cosine Filtering for CompCor.** Users can now configure nuisance correction to perform cosine filtering on the time series data prior to CompCor calculation.

* **Motion Estimation Before Slice Timing Correction.** Users now have the option to calculate motion parameter estimation before slice timing correction, with actual motion correction still occurring after slice timing correction. The motion parameters go on to be used in nuisance regression and statistics reporting.

* **N4 Correction for EPI.** Users can now apply N4 Bias correction to the mean EPI image. This may help enhance coregistration quality.

**NEW FEATURES - Options that facilitate nonhuman data processing**

* **EPI-Based Registration.** Users can now register their BOLD data directly to an EPI template, foregoing structural-to-template registration, if desired.

* **Template-Based Segmentation.** Optimal for use with functional-only pipelines commonly used for rodent data, users can now employ a template-based tissue segmentation approach that applies inverse registration transforms to template-space tissue priors.

* **Rodent Data compatibility.** The pipeline now has an option to size-scale rodent brains to a larger size as an initial preprocessing step to prepare rodent data for processing tools.

* **U-Net Brain Extraction Model.** U-Net is a Fully Convolutional Network (FCN) that does image segmentation. Users can now select this option for brain extraction, especially optimal for non-human primate data.

**IMPROVEMENTS**

* **Dramatically reducing working directory size.** When running aCompCor: the space requirements of the working directory has been reduced to a sustainable size. A change in the previous version resulted in too-large intermediate files for aCompCor calculation.
Some redundancies in the pipeline during time series extraction have been removed, and the pipeline now consumes less memory and disk space during processing.

**BUG FIXES - Quality Control Interface**

* The Quality Control interface is fully functional once again. We apologize for the instability in recent versions, in which QC images and metrics would be generated, but the HTML portal would not generate properly.

The C-PAC Team
^^^^^^^^^^^^^^
.. line-block::

   **Primary Development Team:**
   Michael Milham (Founder, Co-Principal Investigator)
   Cameron Craddock (Co-Principal Investigator)
   Steven Giavasis (Lead Developer)
   Jon Clucas (Developer)
   Hecheng Jin (Developer)
   Xinhui Li (Developer)

   **Project Alumni:**
   Anibal Solon Heinsfeld
   Nanditha Rajamani
   Alison Walensky
   David O'Connor
   Carol Froehlich
   John Pellman
   Amalia MacDonald
   Daniel Clark
   Rosalia Tungaraza
   Daniel Lurie
   Zarrar Shehzad
   Krishna Somandepali
   Aimi Watanabe
   Qingyang Li
   Ranjit Khanuja
   Sharad Sikka
   Brian Cheung

   **Other Contributors:**
   Ivan J. Roijals-Miras (Google Summer of Code)
   Florian Gesser (Google Summer of Code)
   Asier Erramuzpe (Google Summer of Code)
   Chao-Gan Yan
   Joshua Vogelstein
   Adriana Di Martino
   F. Xavier Castellanos
   Sebastian Urchs
   Bharat Biswal

Funding Acknowledgements
^^^^^^^^^^^^^^^^^^^^^^^^
Primary support for the work by Michael P. Milham, Cameron Craddock and the INDI team was provided by gifts from Joseph P. Healey and the `Stavros Niarchos Foundation <http://www.snf.org/>`_ to the `Child Mind Institute <http://www.childmind.org/>`_, as well as by `NIMH <http://www.nimh.nih.gov/index.shtml>`_ awards to Dr. Milham (R03MH096321) and F.X. Castellanos (R01MH083246).

User Guide Index
----------------

.. toctree::
   :maxdepth: 2

   1. End-to-end walkthrough <end-to-end-walkthrough>
   2. C-PAC Quickstart <quick>
   3. Specify Your Data <subject_list_config>
   4. Select Your Pipeline <pipeline_config>
   5. Pre-Process Your Data <preprocessing>
   6. Compute Derivatives <derivatives>
   7. All Run Options <running>
   8. Run Group Analysis <group_analysis>
   9. Check Your Outputs <output_dir>
   10. Troubleshoot <help>
   11. Release Notes <rnotes>
   12. Appendix <appendix>
