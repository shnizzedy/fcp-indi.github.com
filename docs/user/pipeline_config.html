
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Setting Up A Pipeline Configuration &#8212; C-PAC 1.6.2 Beta documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    
    <link rel="index" title="Index" href="genindex" />
    <link rel="search" title="Search" href="search" />
    <link rel="next" title="Pre-Processing Steps" href="preprocessing" />
    <link rel="prev" title="Setting Up A Data Configuration File (Participant/Subject List)" href="subject_list_config" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="preprocessing" title="Pre-Processing Steps"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="subject_list_config" title="Setting Up A Data Configuration File (Participant/Subject List)"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index">C-PAC 1.6.2 Beta documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="setting-up-a-pipeline-configuration">
<h1>Setting Up A Pipeline Configuration<a class="headerlink" href="#setting-up-a-pipeline-configuration" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>This section explains how to create a new pipeline or edit an existing one. If you wish to use one of the pre-configured pipelines that come packaged with C-PAC, you can view the current available library of <a class="reference internal" href="preconfig"><span class="doc">pipelines here</span></a>.</p>
<p>There are two ways of setting up or editing a pipeline configuration for C-PAC:</p>
<ul class="simple">
<li>Using the pipeline configuration interface in the C-PAC GUI</li>
<li>Using a text editor (useful for remote servers where using the C-PAC GUI is not possible or impractical)</li>
</ul>
<div class="section" id="definitions">
<h3>Definitions<a class="headerlink" href="#definitions" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><dl class="first docutils">
<dt>Workflow</dt>
<dd>A workflow accomplishes a particular processing task (e.g. functional preprocessing, scrubbing, nuisance correction). Each workflow can be turned on or off in the pipeline configuration.  Sometimes a workflow can be set to both on and off, allowing for pipelines to branch.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Pipeline</dt>
<dd>A pipeline is a combination of workflows.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Strategy</dt>
<dd>A strategy is a set of preprocessing options. Specifically, a strategy is defined by nuisance corrections and scrubbing settings. Strategies can branch depending on which of these workflows are turned on or off and how they are configured.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Derivative</dt>
<dd>Derivatives are the results of processing a participant’s raw data (i.e., connectivity measures).</dd>
</dl>
</li>
</ul>
</div>
</div>
<div class="section" id="design-a-pipeline">
<h2>Design A Pipeline<a class="headerlink" href="#design-a-pipeline" title="Permalink to this headline">¶</a></h2>
<p>C-PAC offers a graphical interface you can use to quickly and easily modify the default pipeline or create your own from scratch:</p>
<p><a class="reference external" href="https://fcp-indi.github.io/C-PAC_GUI/versions/latest/browser/#/">https://fcp-indi.github.io/C-PAC_GUI/versions/latest/browser/#/</a></p>
<div class="figure">
<img alt="_images/gui_home1.png" src="_images/gui_home1.png" />
</div>
<p>Once you save the pipeline configuration YAML file, you can provide it to the C-PAC Docker container like so:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">docker run -i --rm \</span>
<span class="go">        -v /Users/You/local_bids_data:/bids_dataset \</span>
<span class="go">        -v /Users/You/some_folder:/outputs \</span>
<span class="go">        -v /tmp:/tmp \</span>
<span class="go">        -v /Users/You/Documents:/configs \</span>
<span class="go">        -v /Users/You/resources:/resources \</span>
<span class="go">        fcpindi/c-pac:latest /bids_dataset /outputs participant --pipeline_file /configs/pipeline_config.yml</span>
</pre></div>
</div>
<p>Or you can provide it to the C-PAC Singularity container like so:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">singularity run \</span>
<span class="go">        -B /Users/You/some_folder:/outputs \</span>
<span class="go">        -B /tmp:/tmp \</span>
<span class="go">        -B /Users/You/Documents:/configs \</span>
<span class="go">        fcpindi_c-pac_latest-{date}-{hash value}.img s3://fcp-indi/data/Projects/ADHD200/RawDataBIDS /outputs participant --pipeline_file /configs/pipeline_config.yml</span>
</pre></div>
</div>
<p><strong>Reporting errors and getting help</strong></p>
<p>Please report errors on the <a class="reference external" href="https://github.com/FCP-INDI/C-PAC/issues">C-PAC github page issue tracker</a>. Please use the <a class="reference external" href="https://groups.google.com/forum/#!forum/cpax_forum">C-PAC google group</a> for help using C-PAC and this application.</p>
</div>
<div class="section" id="using-a-text-editor">
<h2>Using a Text Editor<a class="headerlink" href="#using-a-text-editor" title="Permalink to this headline">¶</a></h2>
<p>From terminal, you can quickly generate a default pipeline configuration YAML file template in the directory you are in:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cpac</span> <span class="n">utils</span> <span class="n">pipe_config</span> <span class="n">new_template</span>
</pre></div>
</div>
<p>You can then edit the file as needed, or leave it as the default. If you want to run the analysis from terminal:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cpac</span> <span class="n">run</span> <span class="o">--</span><span class="n">pipe_config</span> <span class="p">{</span><span class="n">path</span> <span class="n">to</span> <span class="n">pipeline</span> <span class="n">config</span><span class="p">}</span> <span class="p">{</span><span class="n">path</span> <span class="n">to</span> <span class="n">data</span> <span class="n">config</span><span class="p">}</span>
</pre></div>
</div>
<p>Pipeline configuration files, like the data settings and data configuration files discussed in the <a class="reference internal" href="subject_list_config"><span class="doc">data configuration builder section</span></a>, are stored as YAML files.  Similarly, each of the parameters used by C-PAC to assemble your pipeline can be specified as key-value pairs, so a pipeline configuration YAML would have multiple lines of the form <code class="docutils literal notranslate"><span class="pre">key:</span> <span class="pre">value</span></code> like so:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Name for this pipeline configuration - useful for identification.</span>
<span class="n">pipelineName</span> <span class="p">:</span>  <span class="n">pipeline01</span>


<span class="c1"># Directory where CPAC should store temporary and intermediate files.</span>
<span class="n">workingDirectory</span> <span class="p">:</span>  <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">runs</span><span class="o">/</span><span class="n">pipeline01</span><span class="o">/</span><span class="n">work</span>


<span class="c1"># Directory where CPAC should write crash logs.</span>
<span class="n">crashLogDirectory</span> <span class="p">:</span>  <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">runs</span><span class="o">/</span><span class="n">pipeline01</span><span class="o">/</span><span class="n">crash</span>


<span class="c1"># Directory where CPAC should place run logs.</span>
<span class="n">logDirectory</span> <span class="p">:</span>  <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">runs</span><span class="o">/</span><span class="n">pipeline01</span><span class="o">/</span><span class="n">log</span>


<span class="c1"># Directory where CPAC should place processed data.</span>
<span class="n">outputDirectory</span> <span class="p">:</span>  <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">runs</span><span class="o">/</span><span class="n">pipeline01</span><span class="o">/</span><span class="n">output</span>
</pre></div>
</div>
<p>An example of a pipeline configuration YAML file can be found <a class="reference external" href="https://raw.githubusercontent.com/FCP-INDI/C-PAC/master/CPAC/resources/configs/pipeline_config_template.yml">here</a>.  Tables explaining the keys and their potential values can be found on the individual pages for each of the outputs C-PAC is capable of producing.  All pipeline configuration files should have the keys in the <a class="reference internal" href="output_config"><span class="doc">Output Settings</span></a> table defined.</p>
<div class="section" id="why-a-list">
<h3>Why a list?<a class="headerlink" href="#why-a-list" title="Permalink to this headline">¶</a></h3>
<p>You may notice as you learn about the settings for various outputs that many of the values for C-PAC’s configurable settings are stored in lists (i.e., multiple values are separated by commas and surrounded by square brackets).  Such lists containing 1s and 0s (for ‘True’ and ‘False’ respectively) allow you to toggle on multiple options at the same time, and branch a pipeline into two different analysis strategies. See the <a class="reference external" href="http://fcp-indi.github.io/docs/developer/workflows/cpac_pipeline.html">developer documentation</a> for more information about how lists are used in C-PAC.</p>
</div>
</div>
<div class="section" id="configurable-settings">
<h2>Configurable Settings<a class="headerlink" href="#configurable-settings" title="Permalink to this headline">¶</a></h2>
<div class="flowchart-container"><object data="_static/flowcharts/pipeline-individual.svg" type="image/svg+xml"></object></div><div class="section" id="data-management-and-environment-settings">
<h3>Data Management and Environment Settings<a class="headerlink" href="#data-management-and-environment-settings" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><a class="reference internal" href="compute_config"><span class="doc">Computer Settings</span></a></li>
<li><a class="reference internal" href="output_config"><span class="doc">Output Settings</span></a></li>
</ul>
</div>
<div class="section" id="pre-and-post-processing">
<h3>Pre- and post-processing<a class="headerlink" href="#pre-and-post-processing" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><a class="reference internal" href="anat"><span class="doc">Anatomical Preprocessing</span></a></li>
<li><a class="reference internal" href="func"><span class="doc">Functional Preprocessing</span></a></li>
<li><a class="reference internal" href="nuisance"><span class="doc">Nuisance Corrections</span></a></li>
<li><a class="reference internal" href="tse"><span class="doc">Time Series Extraction</span></a></li>
<li><a class="reference internal" href="after_warp"><span class="doc">After Warp Settings</span></a></li>
</ul>
</div>
<div class="section" id="derivatives">
<h3>Derivatives<a class="headerlink" href="#derivatives" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><a class="reference internal" href="sca"><span class="doc">Seed-based Correlation Analysis (SCA) and Dual Regression</span></a> - Analyze the connectivity between brain regions.</li>
<li><a class="reference internal" href="vmhc"><span class="doc">Voxel-mirrored Homotopic Connectivity (VMHC)</span></a> - Investigate connectivity between hemispheres.</li>
<li><a class="reference internal" href="alff"><span class="doc">Amplitude of Low Frequency Fluctuations (ALFF) and fractional ALFF (fALFF)</span></a> - Measure the power of slow fluctuations in brain activity.</li>
<li><a class="reference internal" href="reho"><span class="doc">Regional Homogeneity (ReHo)</span></a> - Measure the similarity of activity patterns across neighboring voxels.</li>
<li><a class="reference internal" href="centrality"><span class="doc">Network Centrality</span></a> - Analyze the structure of functional networks.</li>
</ul>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index">
              <img class="logo" src="_static/cpac_logo_vertical.png" alt="Logo"/>
            </a></p>
<h3><a href="index">Table of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="quick">1. C-PAC Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="subject_list_config">2. Specify Your Data</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">3. Select Your Pipeline</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#design-a-pipeline">Design A Pipeline</a></li>
<li class="toctree-l2"><a class="reference internal" href="#using-a-text-editor">Using a Text Editor</a></li>
<li class="toctree-l2"><a class="reference internal" href="#configurable-settings">Configurable Settings</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="preprocessing">4. Pre-Process Your Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="derivatives">5. Compute Derivatives</a></li>
<li class="toctree-l1"><a class="reference internal" href="running">6. All Run Options</a></li>
<li class="toctree-l1"><a class="reference internal" href="group_analysis">7. Run Group Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="output_dir">8. Check Your Outputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="help">9. Troubleshoot</a></li>
<li class="toctree-l1"><a class="reference internal" href="rnotes">10. Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="appendix">Appendix</a></li>
<li class="toctree-l1"><a class="reference internal" href="appendix#benchmark-package">Benchmark Package</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="preprocessing" title="Pre-Processing Steps"
             >next</a> |</li>
        <li class="right" >
          <a href="subject_list_config" title="Setting Up A Data Configuration File (Participant/Subject List)"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index">C-PAC 1.6.2 Beta documentation</a> &#187;</li> 
      </ul>
    </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2020, C-PAC Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.4.
    </div>
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-19224662-10"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-19224662-10');
    </script>

  </body>
</html>